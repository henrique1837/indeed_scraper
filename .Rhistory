.variables = .(date),
summarize,
totalJobs=sum(length(df_t$date)))
df_t$count <- 1
df_agreggated <- d_ply(.data = df_t,
.variables = .(date),
summarize,
totalJobs=sum(count))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
df_t$count <- 1
View(df_t)
df_agreggated <- d_ply(.data = df_t,
.variables = .(date),
summarize,
totalJobs=sum(count))
sum(df_t$count)
d_ply(.data = df_t,
.variables = .(date),
.fun = summarize,
totalJobs=sum(count))
df_agreggated <- ddply(.data = df_t,
.variables = .(date),
.fun = summarize,
totalJobs=sum(count))
View(df_agreggated)
View(df_t)
library(plyr)
library(stringr)
library(ggplot2)
setwd("~/Documentos/scripts/indeed_scraper/")
#### Read data ####
files <- Sys.glob("./results/*")
df <- read.csv(file = files[1])
df_t <- df[which(!(str_detect(string = df$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
View(df_t)
df_t$count <- 1
df_agreggated <- ddply(.data = df_t,
.variables = .(date),
.fun = summarize,
totalJobs=sum(count))
View(df_agreggated)
df_companies <- ddply(.data = df_t,
.variables = .(date,company),
.fun = summarize,
totalJobs=sum(count))
View(df_companies)
ggplot(data = df_agreggated,
mapping = aes(x=date,y=count)) +
geom_point() +
geom_smooth()
ggplot(data = df_agreggated,
mapping = aes(x=date,y=count)) +
geom_point()
str(df_agreggated)
ggplot(data = df_agreggated,
mapping = aes(x=date,y=totalJobs)) +
geom_point()
ggplot(data = df_agreggated,
mapping = aes(x=date,y=totalJobs)) +
geom_point() +
geom_smooth()
ggplot(data = df_agreggated,
mapping = aes(x=date,y=totalJobs)) +
geom_point() +
geom_smooth(formula = y~x,
method = "loess")
View(df_agreggated)
df <- read.csv(file = files[2])
df_t2 <- df[which(!(str_detect(string = df$date,
pattern = "30+"))),]
df_t <- merge(df_t,df_t2)
file_date <- as.Date(str_extract(string = files[2],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t2$date <- file_date - as.numeric(str_extract(string = df_t2$date,
pattern = "[[:digit:]]+"))
df_t <- merge(df_t,df_t2)
df_t$count <- 1
df_t$count <- 1
df <- read.csv(file = files[1])
df_t <- df[which(!(str_detect(string = df$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
df_t$count <- 1
df_agreggated <- ddply(.data = df_t,
.variables = .(date),
.fun = summarize,
totalJobs=sum(count))
df_companies <- ddply(.data = df_t,
.variables = .(date,company),
.fun = summarize,
totalJobs=sum(count))
ggplot(data = df_agreggated,
mapping = aes(x=date,y=totalJobs)) +
geom_point() +
geom_smooth(formula = y~x,
method = "loess")
ggplot(data = df_companies,
mapping = aes(x=date,y=company)) +
geom_tile(aes(fill = totalJobs)) +
scale_fill_gradient(low = "white",high = "steelblue")
ggplot(data = head(df_companies[order(df_companies$totalJobs,
decreasing = TRUE),]),
mapping = aes(x=date,y=company)) +
geom_tile(aes(fill = totalJobs)) +
scale_fill_gradient(low = "white",high = "steelblue")
ggplot(data = head(df_companies[order(df_companies$totalJobs,
decreasing = TRUE),],15),
mapping = aes(x=date,y=company)) +
geom_tile(aes(fill = totalJobs)) +
scale_fill_gradient(low = "white",high = "steelblue")
ggplot(data = head(df_companies[order(df_companies$totalJobs,
decreasing = TRUE),],30),
mapping = aes(x=date,y=company)) +
geom_tile(aes(fill = totalJobs)) +
scale_fill_gradient(low = "white",high = "steelblue")
ggplot(data = head(df_companies[order(df_companies$totalJobs,
decreasing = TRUE),],20),
mapping = aes(x=date,y=company)) +
geom_tile(aes(fill = totalJobs)) +
scale_fill_gradient(low = "white",high = "steelblue")
ggplot(data = df_companies,
mapping = aes(x=company,y=totalJobs)) +
geom_point() +
geom_smooth(formula = y~x,
method = "loess")
ggplot(data = df_companies,
mapping = aes(x=company,y=totalJobs)) +
geom_bar() +
geom_smooth(formula = y~x,
method = "loess")
ggplot(data = df_companies,
mapping = aes(x=company,y=totalJobs)) +
geom_bar()
ggplot(data = df_companies,
mapping = aes(x=company,y=totalJobs)) +
geom_bar(col="black",fill="steelblue",stat = "identity")
ggplot(data = df_companies,
mapping = aes(x=company,y=totalJobs)) +
geom_bar(col="black",fill="steelblue",stat = "identity") +
theme(axis.text.x=element_text(angle = -90, hjust = 0))
ggplot(data = head(df_companies[order(df_companies$totalJobs,
decreasing = TRUE),],20),
mapping = aes(x=company,y=totalJobs)) +
geom_bar(col="black",fill="steelblue",stat = "identity") +
theme(axis.text.x=element_text(angle = -90, hjust = 0))
ggplot(data = head(df_companies[order(df_companies$totalJobs,
decreasing = TRUE),],10),
mapping = aes(x=company,y=totalJobs)) +
geom_bar(col="black",fill="steelblue",stat = "identity") +
theme(axis.text.x=element_text(angle = -90, hjust = 0))
View(df_companies)
ggplot(data = head(df_companies[order(df_companies$totalJobs,
decreasing = TRUE),],10),
mapping = aes(x=company,y=totalJobs)) +
geom_bar(col="black",fill="steelblue",stat = "identity") +
theme(axis.text.x=element_text(angle = -45, hjust = 0))
df_list <- list(read.csv(file = files[1]))
df_list <- list(read.csv(file = files[1]))
for(i in 2:length(files)){
df_list[[i]] <- read.csv(file = files[i])
df_t <- merge(df_list[[i-1]],df_list[[i]])
}
df_list <- list(read.csv(file = files[1]))
for(i in 2:length(files)){
df_list[[i]] <- read.csv(file = files[i])
df_t <- merge(df_list[[i-1]],df_list[[i]])
message("Merging files ",i)
}
View(df_t)
i = 2
df_list <- list(read.csv(file = files[1]))
df_list[[i]] <- read.csv(file = files[i])
df_list[1]
df_t <- read.csv(file = files[1])
#### Read data ####
files <- Sys.glob("./results/*")
df_t <- read.csv(file = files[1])
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
file_date[1] <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
files <- Sys.glob("./results/*")
df_t <- read.csv(file = files[1])
file_date[1] <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t <- df_t[which(!(str_detect(string = df_t$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
files <- Sys.glob("./results/*")
df_t <- read.csv(file = files[1])
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t <- df_t[which(!(str_detect(string = df_t$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
for(i in 2:length(files)){
df[[i]] <- read.csv(file = files[i])
file_date <- as.Date(str_extract(string = files[i],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df$date <- file_date - as.numeric(str_extract(string = df$date,
pattern = "[[:digit:]]+"))
df_t <- merge(df_t,df)
message("Merging files ",i)
}
i = 2
files <- Sys.glob("./results/*")
df_t <- read.csv(file = files[1])
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t <- df_t[which(!(str_detect(string = df_t$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
i = 2
df <- read.csv(file = files[i])
file_date <- as.Date(str_extract(string = files[i],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df$date <- file_date - as.numeric(str_extract(string = df$date,
pattern = "[[:digit:]]+"))
df_t <- merge(df_t,df)
df <- read.csv(file = files[i])
df <- df[which(!(str_detect(string = df$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[i],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df$date <- file_date - as.numeric(str_extract(string = df$date,
pattern = "[[:digit:]]+"))
df$date <- file_date - as.numeric(str_extract(string = df$date,
pattern = "[[:digit:]]+"))
files <- Sys.glob("./results/*")
df_t <- read.csv(file = files[1])
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t <- df_t[which(!(str_detect(string = df_t$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
df <- read.csv(file = files[i])
df <- df[which(!(str_detect(string = df$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[i],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df$date <- file_date - as.numeric(str_extract(string = df$date,
pattern = "[[:digit:]]+"))
df_t <- merge(df_t,df)
files <- Sys.glob("./results/*")
df_t <- read.csv(file = files[1])
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t <- df_t[which(!(str_detect(string = df_t$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
df <- read.csv(file = files[i])
df <- df[which(!(str_detect(string = df$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[i],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df$date <- file_date - as.numeric(str_extract(string = df$date,
pattern = "[[:digit:]]+"))
df_t <- rbind(df_t,df[which(!(df$link %in% df_t$link)),])
files <- Sys.glob("./results/*")
df_t <- read.csv(file = files[1])
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t <- df_t[which(!(str_detect(string = df_t$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
for(i in 2:length(files)){
df <- read.csv(file = files[i])
df <- df[which(!(str_detect(string = df$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[i],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df$date <- file_date - as.numeric(str_extract(string = df$date,
pattern = "[[:digit:]]+"))
df_t <- rbind(df_t,df[which(!(df$link %in% df_t$link)),])
message("Files ",i," - ",length(files))
}
df_t$count <- 1
df_agreggated <- ddply(.data = df_t,
.variables = .(date),
.fun = summarize,
totalJobs=sum(count))
df_companies <- ddply(.data = df_t,
.variables = .(date,company),
.fun = summarize,
totalJobs=sum(count))
## Total jobs posted by day ##
ggplot(data = df_agreggated,
mapping = aes(x=date,y=totalJobs)) +
geom_point() +
geom_smooth(formula = y~x,
method = "loess")
View(df)
View(df)
df$date[which(is.na(df$date))]
files <- Sys.glob("./results/*")
df_t <- read.csv(file = files[1])
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t <- df_t[which(!(str_detect(string = df_t$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
for(i in 2:length(files)){
df <- read.csv(file = files[i])
df <- df[which(!(str_detect(string = df$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[i],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df$date <- file_date - as.numeric(str_extract(string = df$date,
pattern = "[[:digit:]]+"))
df$date[which(is.na(df$date))] <- file_date
df_t <- rbind(df_t,df[which(!(df$link %in% df_t$link)),])
message("Files ",i," - ",length(files))
}
df_t$count <- 1
df_agreggated <- ddply(.data = df_t,
.variables = .(date),
.fun = summarize,
totalJobs=sum(count))
df_companies_date <- ddply(.data = df_t,
.variables = .(date,company),
.fun = summarize,
totalJobs=sum(count))
df_companies <- ddply(.data = df_t,
.variables = .(company),
.fun = summarize,
totalJobs=sum(count))
View(df)
df_t$count <- 1
df_agreggated <- ddply(.data = df_t,
.variables = .(date),
.fun = summarize,
totalJobs=sum(count))
df_companies_date <- ddply(.data = df_t,
.variables = .(date,company),
.fun = summarize,
totalJobs=sum(count))
df_companies <- ddply(.data = df_t,
.variables = .(company),
.fun = summarize,
totalJobs=sum(count))
df_places <- ddply(.data = df_t,
.variables = .(location),
.fun = summarize,
totalJobs=sum(count))
## Top 20 places ##
ggplot(data = head(df_places[order(df_places$totalJobs,
decreasing = TRUE),],20),
mapping = aes(x=location,y=totalJobs)) +
geom_bar(col="black",fill="steelblue",stat = "identity") +
theme(axis.text.x=element_text(angle = -45, hjust = 0))
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(stringr)
library(ggplot2)
#### Read data ####
files <- Sys.glob("./results/*")
df_t <- read.csv(file = files[1])
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t <- df_t[which(!(str_detect(string = df_t$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
for(i in 2:length(files)){
df <- read.csv(file = files[i])
df <- df[which(!(str_detect(string = df$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[i],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df$date <- file_date - as.numeric(str_extract(string = df$date,
pattern = "[[:digit:]]+"))
df$date[which(is.na(df$date))] <- file_date
df_t <- rbind(df_t,df[which(!(df$link %in% df_t$link)),])
message("Files ",i," - ",length(files))
}
df_t$count <- 1
df_agreggated <- ddply(.data = df_t,
.variables = .(date),
.fun = summarize,
totalJobs=sum(count))
df_companies_date <- ddply(.data = df_t,
.variables = .(date,company),
.fun = summarize,
totalJobs=sum(count))
df_companies <- ddply(.data = df_t,
.variables = .(company),
.fun = summarize,
totalJobs=sum(count))
df_places <- ddply(.data = df_t,
.variables = .(location),
.fun = summarize,
totalJobs=sum(count))
range(df_t$date)
knitr::opts_chunk$set(echo = FALSE)
library(plyr)
library(stringr)
library(ggplot2)
#### Read data ####
files <- Sys.glob("./results/*")
df_t <- read.csv(file = files[1])
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t <- df_t[which(!(str_detect(string = df_t$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[1],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df_t$date <- file_date - as.numeric(str_extract(string = df_t$date,
pattern = "[[:digit:]]+"))
for(i in 2:length(files)){
df <- read.csv(file = files[i])
df <- df[which(!(str_detect(string = df$date,
pattern = "30+"))),]
file_date <- as.Date(str_extract(string = files[i],
pattern = "[[:digit:]]{4}-[[:digit:]]{2}-[[:digit:]]{2}"))
df$date <- file_date - as.numeric(str_extract(string = df$date,
pattern = "[[:digit:]]+"))
df$date[which(is.na(df$date))] <- file_date
df_t <- rbind(df_t,df[which(!(df$link %in% df_t$link)),])
message("Files ",i," - ",length(files))
}
df_t$count <- 1
df_agreggated <- ddply(.data = df_t,
.variables = .(date),
.fun = summarize,
totalJobs=sum(count))
df_companies_date <- ddply(.data = df_t,
.variables = .(date,company),
.fun = summarize,
totalJobs=sum(count))
df_companies <- ddply(.data = df_t,
.variables = .(company),
.fun = summarize,
totalJobs=sum(count))
df_places <- ddply(.data = df_t,
.variables = .(location),
.fun = summarize,
totalJobs=sum(count))
## Top 20 places ##
ggplot(data = head(df_places[order(df_places$totalJobs,
decreasing = TRUE),],20),
mapping = aes(x=location,y=totalJobs)) +
geom_bar(col="black",fill="steelblue",stat = "identity") +
theme(axis.text.x=element_text(angle = -45, hjust = 0))
## Top 20 companies jobs by date ##
ggplot(data = head(df_companies_date[order(df_companies_date$totalJobs,
decreasing = TRUE),],20),
mapping = aes(x=date,y=company)) +
geom_tile(aes(fill = totalJobs)) +
scale_fill_gradient(low = "white",high = "steelblue")
sessionInfo()
## Total jobs posted by day ##
ggplot(data = df_agreggated,
mapping = aes(x=date,y=totalJobs)) +
geom_point() +
geom_smooth(formula = y~x,
method = "loess")
## Top 20 companies ##
ggplot(data = head(df_companies[order(df_companies$totalJobs,
decreasing = TRUE),],20),
mapping = aes(x=company,y=totalJobs)) +
geom_bar(col="black",fill="steelblue",stat = "identity") +
theme(axis.text.x=element_text(angle = -45, hjust = 0))
## Top 20 places ##
ggplot(data = head(df_places[order(df_places$totalJobs,
decreasing = TRUE),],20),
mapping = aes(x=location,y=totalJobs)) +
geom_bar(col="black",fill="steelblue",stat = "identity") +
theme(axis.text.x=element_text(angle = -45, hjust = 0))
## Top 20 companies jobs by date ##
ggplot(data = head(df_companies_date[order(df_companies_date$totalJobs,
decreasing = TRUE),],20),
mapping = aes(x=date,y=company)) +
geom_tile(aes(fill = totalJobs)) +
scale_fill_gradient(low = "ligthblue",high = "steelblue")
## Top 20 companies jobs by date ##
ggplot(data = head(df_companies_date[order(df_companies_date$totalJobs,
decreasing = TRUE),],20),
mapping = aes(x=date,y=company)) +
geom_tile(aes(fill = totalJobs)) +
scale_fill_gradient(low = "lightblue",high = "steelblue")
